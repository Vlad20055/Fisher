https://dbdiagram.io/d

// Таблица пользователей
Table users {
  id uint [primary key, increment]
  username text [unique, not null]
  password_hash text [not null]
  full_name text [not null]
  role_id uint [not null]
  is_active boolean
}

// Таблица ролей
Table roles {
  id uint [primary key, increment]
  name text [not null, unique]
}

// Таблица магазинов
Table stores {
  id uint [primary key, increment]
  name text [not null]
  address text [not null]
  tax_id text [unique, not null]
  manager_id uint [not null]
}

// Таблица категорий товаров
Table categories {
  id uint [primary key, increment]
  name text [not null, unique]
}

// Таблица товаров
Table products {
  id uint [primary key, increment]
  name text [not null]
  description text
  price decimal [not null]
  quantity_in_stock uint [default: 0]
  category_id uint [not null]
}

// Таблица заказов
Table orders {
  id uint [primary key, increment]
  store_id uint [not null]
  total_amount decimal [not null]
  created_at timestamp [default: `now()`]
}

// Таблица позиций заказа
Table order_items {
  id uint [primary key, increment]
  order_id uint [not null]
  product_id uint [not null]
  quantity uint [not null]
  unit_price decimal [not null]
}

// Таблица счета компании
Table company_accounts {
  id uint [primary key, increment]
  balance decimal [default: 0.0]
}

// Таблица транзакций
Table transactions {
  id uint [primary key, increment]
  store_account_id uint [not null]
  company_account_id uint [not null]
  amount decimal [not null]

}

// Таблица журнала аудита
Table audit_log {
  id uint [primary key, increment]
  user_id uint
  details text
  performed_at timestamp [default: `now()`]
}

Table store_accounts {
  id uint [primary key, increment]
  balance decimal [default: 0.0]
  store_id uint [not null]
}

// Связи между таблицами
// Связи между таблицами

// 1:1 связи
Ref: stores.manager_id - users.id
Ref: store_accounts.store_id - stores.id

// 1:M связи
Ref: users.role_id > roles.id
Ref: products.category_id > categories.id
Ref: orders.store_id > stores.id
Ref: order_items.order_id > orders.id
Ref: order_items.product_id > products.id
Ref: audit_log.user_id > users.id

// Связи для транзакций (1:M)
Ref: store_accounts.id > transactions.store_account_id
Ref: company_accounts.id > transactions.company_account_id